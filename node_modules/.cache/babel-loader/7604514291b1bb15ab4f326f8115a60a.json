{"ast":null,"code":"import _toConsumableArray from\"/Users/artempudovkin/dev/mesto-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/artempudovkin/dev/mesto-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from'react';import Header from\"./Header\";import Main from\"./Main\";import PopupWithForm from\"./PopupWithForm\";import ImagePopup from\"./ImagePopup\";import api from\"../utils/api\";import{CurrentUserContext}from\"../contexts/CurrentUserContext\";import Footer from\"./Footer\";import EditProfilePopup from\"./EditProfilePopup\";import EditAvatarPopup from\"./EditAvatarPopup\";import AddPlacePopup from\"./AddPlacePopup\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(){var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),isEditProfilePopupOpen=_React$useState2[0],setIsEditProfilePopupOpen=_React$useState2[1];var _React$useState3=React.useState(false),_React$useState4=_slicedToArray(_React$useState3,2),isAddPlacePopupOpen=_React$useState4[0],setIsAddPlacePopupOpen=_React$useState4[1];var _React$useState5=React.useState(false),_React$useState6=_slicedToArray(_React$useState5,2),isEditAvatarPopupOpen=_React$useState6[0],setIsEditAvatarPopupOpen=_React$useState6[1];var _React$useState7=React.useState(false),_React$useState8=_slicedToArray(_React$useState7,2),isImagePopupOpen=_React$useState8[0],setImagePopupOpen=_React$useState8[1];var _React$useState9=React.useState({}),_React$useState10=_slicedToArray(_React$useState9,2),selectedCard=_React$useState10[0],setSelectedCard=_React$useState10[1];var _React$useState11=React.useState({}),_React$useState12=_slicedToArray(_React$useState11,2),currentUser=_React$useState12[0],setCurrentUser=_React$useState12[1];var _React$useState13=React.useState([]),_React$useState14=_slicedToArray(_React$useState13,2),cards=_React$useState14[0],setCards=_React$useState14[1];React.useEffect(function(){api.getInitialCards().then(function(cardList){setCards(cardList);}).catch(function(err){console.log(err);});},[]);function handleCardLike(card){var isLiked=card.likes.some(function(i){return i._id===currentUser._id;});api.changeLikeCardStatus(card._id,isLiked).then(function(newCard){//const newCards = cards.map((currentCard) => currentCard._id === card._id ? newCard : currentCard)\n//setCards(newCards)\nsetCards(function(cards){return cards.map(function(currentCard){return currentCard._id===card._id?newCard:currentCard;});});}).catch(function(err){console.log(err);});}function handleCardDelete(card){api.removeCard(card._id).then(function(){var newCards=cards.filter(function(elem){return elem!==card;});setCards(newCards);}).catch(function(err){console.log(err);});}React.useEffect(function(){api.getUserInfo().then(function(data){setCurrentUser(data);}).catch(function(err){console.log(err);});},[]);function handleEditAvatarClick(){setIsEditAvatarPopupOpen(true);}function handleEditProfileClick(){setIsEditProfilePopupOpen(true);}function handleAddPlaceClick(){setIsAddPlacePopupOpen(true);}function closeAllPopups(){setIsEditAvatarPopupOpen(false);setIsEditProfilePopupOpen(false);setIsAddPlacePopupOpen(false);setImagePopupOpen(false);setSelectedCard({});}function handleCardClick(card){setSelectedCard(card);setImagePopupOpen(true);}function handleUpdateUser(_ref){var name=_ref.name,about=_ref.about;api.editUserInfo(name,about).then(function(data){setCurrentUser(data);closeAllPopups();}).catch(function(err){console.log(err);});}function handleUpdateAvatar(_ref2){var avatar=_ref2.avatar;api.editUserAvatar(avatar).then(function(data){setCurrentUser(data);closeAllPopups();}).catch(function(err){console.log(err);});}function handleAddPlaceSubmit(_ref3){var name=_ref3.name,link=_ref3.link;api.addCard(name,link).then(function(data){setCards([data].concat(_toConsumableArray(cards)));closeAllPopups();}).catch(function(err){console.log(err);});}return/*#__PURE__*/_jsx(CurrentUserContext.Provider,{value:currentUser,children:/*#__PURE__*/_jsx(\"div\",{className:\"page\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"page__container\",children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsx(Main,{onEditProfile:handleEditProfileClick,onAddPlace:handleAddPlaceClick,onEditAvatar:handleEditAvatarClick,onCardClick:handleCardClick,onCardLike:handleCardLike,cards:cards,onCardDelete:handleCardDelete}),/*#__PURE__*/_jsx(Footer,{}),/*#__PURE__*/_jsx(EditProfilePopup,{isOpen:isEditProfilePopupOpen,onClose:closeAllPopups,onUpdateUser:handleUpdateUser}),/*#__PURE__*/_jsx(EditAvatarPopup,{isOpen:isEditAvatarPopupOpen,onClose:closeAllPopups,onUpdateAvatar:handleUpdateAvatar}),/*#__PURE__*/_jsx(AddPlacePopup,{isOpen:isAddPlacePopupOpen,onClose:closeAllPopups,onAddPlace:handleAddPlaceSubmit}),/*#__PURE__*/_jsx(PopupWithForm,{title:\"\\u0412\\u044B \\u0443\\u0432\\u0435\\u0440\\u0435\\u043D\\u044B?\",name:\"remove-card\",buttonText:\"\\u0414\\u0430\",onClose:closeAllPopups}),/*#__PURE__*/_jsx(ImagePopup,{card:selectedCard,onClose:closeAllPopups,isOpen:isImagePopupOpen})]})})});}export default App;","map":{"version":3,"sources":["/Users/artempudovkin/dev/mesto-react/src/components/App.js"],"names":["React","Header","Main","PopupWithForm","ImagePopup","api","CurrentUserContext","Footer","EditProfilePopup","EditAvatarPopup","AddPlacePopup","App","useState","isEditProfilePopupOpen","setIsEditProfilePopupOpen","isAddPlacePopupOpen","setIsAddPlacePopupOpen","isEditAvatarPopupOpen","setIsEditAvatarPopupOpen","isImagePopupOpen","setImagePopupOpen","selectedCard","setSelectedCard","currentUser","setCurrentUser","cards","setCards","useEffect","getInitialCards","then","cardList","catch","err","console","log","handleCardLike","card","isLiked","likes","some","i","_id","changeLikeCardStatus","newCard","map","currentCard","handleCardDelete","removeCard","newCards","filter","elem","getUserInfo","data","handleEditAvatarClick","handleEditProfileClick","handleAddPlaceClick","closeAllPopups","handleCardClick","handleUpdateUser","name","about","editUserInfo","handleUpdateAvatar","avatar","editUserAvatar","handleAddPlaceSubmit","link","addCard"],"mappings":"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","sourcesContent":["import React from 'react'\nimport Header from \"./Header\";\nimport Main from \"./Main\";\nimport PopupWithForm from \"./PopupWithForm\"\nimport ImagePopup from \"./ImagePopup\"\nimport api from \"../utils/api\";\nimport {CurrentUserContext} from \"../contexts/CurrentUserContext\";\n\nimport Footer from \"./Footer\";\nimport EditProfilePopup from \"./EditProfilePopup\";\nimport EditAvatarPopup from \"./EditAvatarPopup\";\nimport AddPlacePopup from \"./AddPlacePopup\";\n\nfunction App() {\n    const [isEditProfilePopupOpen, setIsEditProfilePopupOpen] = React.useState(false);\n    const [isAddPlacePopupOpen, setIsAddPlacePopupOpen] = React.useState(false);\n    const [isEditAvatarPopupOpen, setIsEditAvatarPopupOpen] = React.useState(false);\n    const [isImagePopupOpen, setImagePopupOpen] = React.useState(false)\n\n    const [selectedCard, setSelectedCard] = React.useState({});\n    const [currentUser, setCurrentUser] = React.useState({});\n\n    const [cards, setCards] = React.useState([]);\n\n    React.useEffect(() => {\n        api.getInitialCards()\n            .then(cardList => {\n                setCards(cardList);\n            })\n            .catch((err) => {\n                console.log(err)\n            })\n    }, [])\n\n    function handleCardLike(card) {\n        const isLiked = card.likes.some(i => i._id === currentUser._id);\n\n        api.changeLikeCardStatus(card._id, isLiked)\n            .then((newCard) => {\n                //const newCards = cards.map((currentCard) => currentCard._id === card._id ? newCard : currentCard)\n                //setCards(newCards)\n                setCards((cards) => cards.map((currentCard) => currentCard._id === card._id ? newCard : currentCard))\n\n            })\n            .catch((err) => {\n                console.log(err)\n            })\n    }\n\n    function handleCardDelete(card) {\n        api.removeCard(card._id)\n            .then(() => {\n                const newCards = cards.filter((elem) => elem !== card);\n                setCards(newCards);\n            })\n            .catch((err) => {\n                console.log(err)\n            })\n    }\n\n    React.useEffect(() => {\n        api.getUserInfo()\n            .then((data) => {\n                setCurrentUser(data)\n            })\n            .catch((err) => {\n                console.log(err)\n            });\n    }, [])\n\n    function handleEditAvatarClick() {\n        setIsEditAvatarPopupOpen(true)\n    }\n\n    function handleEditProfileClick() {\n        setIsEditProfilePopupOpen(true)\n    }\n\n    function handleAddPlaceClick() {\n        setIsAddPlacePopupOpen(true)\n    }\n\n    function closeAllPopups() {\n        setIsEditAvatarPopupOpen(false)\n        setIsEditProfilePopupOpen(false)\n        setIsAddPlacePopupOpen(false)\n        setImagePopupOpen(false)\n        setSelectedCard({})\n    }\n\n    function handleCardClick(card) {\n        setSelectedCard(card)\n        setImagePopupOpen(true)\n    }\n\n    function handleUpdateUser({name, about}) {\n        api.editUserInfo(name, about)\n            .then((data) => {\n                setCurrentUser(data);\n                closeAllPopups();\n            })\n            .catch((err) => {\n                console.log(err)\n            })\n    }\n\n    function handleUpdateAvatar({avatar}) {\n        api.editUserAvatar(avatar)\n            .then((data) => {\n                setCurrentUser(data);\n                closeAllPopups();\n            })\n            .catch((err) => {\n                console.log(err)\n            })\n    }\n\n    function handleAddPlaceSubmit({name, link}) {\n        api.addCard(name, link)\n            .then((data) => {\n                setCards([data, ...cards]);\n                closeAllPopups()\n            })\n            .catch((err) => {\n                console.log(err)\n            })\n    }\n\n    return (\n        <CurrentUserContext.Provider value={currentUser}>\n            <div className=\"page\">\n                <div className=\"page__container\">\n                    <Header/>\n                    <Main onEditProfile={handleEditProfileClick} onAddPlace={handleAddPlaceClick}\n                          onEditAvatar={handleEditAvatarClick} onCardClick={handleCardClick}\n                          onCardLike={handleCardLike} cards={cards}\n                          onCardDelete={handleCardDelete}/>\n                    <Footer/>\n                    <EditProfilePopup isOpen={isEditProfilePopupOpen} onClose={closeAllPopups}\n                                      onUpdateUser={handleUpdateUser}/>\n                    <EditAvatarPopup isOpen={isEditAvatarPopupOpen} onClose={closeAllPopups}\n                                     onUpdateAvatar={handleUpdateAvatar}/>\n                    <AddPlacePopup isOpen={isAddPlacePopupOpen} onClose={closeAllPopups}\n                                   onAddPlace={handleAddPlaceSubmit}/>\n\n                    <PopupWithForm\n                        title=\"Вы уверены?\"\n                        name=\"remove-card\"\n                        buttonText=\"Да\"\n                        onClose={closeAllPopups}>\n                    </PopupWithForm>\n                    <ImagePopup\n                        card={selectedCard}\n                        onClose={closeAllPopups}\n                        isOpen={isImagePopupOpen}/>\n                </div>\n            </div>\n        </CurrentUserContext.Provider>\n    );\n}\n\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}